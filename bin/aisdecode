#! /usr/bin/env python

import ais
import sys
import json
import ais.compatibility.gpsd


buf = []
for row in sys.stdin:
    buf.append(row)
    body = ''.join([line.split(',')[5] for line in buf])
    pad = int(buf[-1].split('*')[0][-1])
    try:
        msg = ais.decode(body, pad)
    except:
        pass
    else:
        json.dump(ais.compatibility.gpsd.mangle(msg), sys.stdout)
        sys.stdout.write("\n")

    del buf[:]
        
 
